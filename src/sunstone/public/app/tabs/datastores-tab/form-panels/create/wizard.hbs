{{! -------------------------------------------------------------------------- }}
{{! Copyright 2002-2019, OpenNebula Project, OpenNebula Systems                }}
{{!                                                                            }}
{{! Licensed under the Apache License, Version 2.0 (the "License"); you may    }}
{{! not use this file except in compliance with the License. You may obtain    }}
{{! a copy of the License at                                                   }}
{{!                                                                            }}
{{! http://www.apache.org/licenses/LICENSE-2.0                                 }}
{{!                                                                            }}
{{! Unless required by applicable law or agreed to in writing, software        }}
{{! distributed under the License is distributed on an "AS IS" BASIS,          }}
{{! WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.   }}
{{! See the License for the specific language governing permissions and        }}
{{! limitations under the License.                                             }}
{{! -------------------------------------------------------------------------- }}

<form data-abide novalidate id="{{formPanelId}}Wizard" class="custom creation">
  <div class="row">
    <div class="medium-6 columns">
      <label for="name" >{{tr "Name"}}</label>
      <input required type="text" name="name" id="name"/>
    </div>
  </div>
  <div class="row">
    <div class="medium-6 columns">
      <label for="presets">{{tr "Storage backend"}}</label>
      <select id="presets" name="presets">
        <option ds="3par" tm="3par" value="3par">{{tr "3PAR"}}</option>
        <option ds="fs" tm="shared" value="fs_shared">{{tr "Filesystem - shared mode"}}</option>
        <option ds="fs" tm="ssh"    value="fs_ssh">{{tr "Filesystem - ssh mode"}}</option>
        <option ds="fs" tm="qcow2"  value="fs_qcow2">{{tr "Filesystem - qcow2 mode"}}</option>
        <option ds="ceph" tm="ceph" value="ceph">{{tr "Ceph"}}</option>
        <option ds="vcenter" tm="vcenter" value="vcenter">{{tr "vCenter"}}</option>
        <option ds="fs" tm="fs_lvm" value="lvm">{{tr "LVM"}}</option>
        <option ds="dev" tm="dev" value="raw">{{tr "Raw Device Mapping"}}</option>
        <option ds="iscsi_libvirt" tm="iscsi_libvirt" value="iscsi_libvirt">{{tr "iSCSI - Libvirt initiator "}}</option>
        <option value="custom">{{tr "Custom"}}</option>
      </select>
    </div>
    <div class="medium-6 columns">
      <label for="cluster">{{tr "Cluster"}}</label>
      <div id="cluster_id" name="cluster_id"></div>
    </div>
  </div>
  <div class="row drivers">
    <div class="large-12 columns">
      <fieldset>
        <legend>{{tr "Drivers"}}</legend>
        <div class="medium-6 columns">
          <label for="ds_mad">{{tr "Datastore"}}</label>
          <select id="ds_mad" name="ds_mad">
            <option value="3par">{{tr "3PAR"}}</option>
            <option value="fs">{{tr "Filesystem"}}</option>
            <option value="ceph">{{tr "Ceph"}}</option>
            <option value="dev">{{tr "Devices"}}</option>
            <option value="iscsi_libvirt">{{tr "iSCSI/Libvirt"}}</option>
            <option value="vcenter">{{tr "vCenter"}}</option>
            <option value="custom">{{tr "Custom"}}</option>
          </select>
          <div>
            <label>{{tr "Custom DS_MAD"}}</label>
            <input type="text" name="ds_tab_custom_ds_mad" />
          </div>
        </div>
        <div class="medium-6 columns">
          <label for="tm_mad">{{tr "Transfer"}}</label>
          <select id="tm_mad" name="tm_mad">
            <option value="3par">{{tr "3PAR"}}</option>
            <option value="shared">{{tr "Shared"}}</option>
            <option value="ssh">{{tr "SSH"}}</option>
            <option value="qcow2">{{tr "qcow2"}}</option>
            <option value="fs_lvm">{{tr "FS LVM"}}</option>
            <option value="ceph">{{tr "Ceph"}}</option>
            <option value="dev">{{tr "Devices"}}</option>
            <option value="iscsi_libvirt">{{tr "iSCSI/Libvirt"}}</option>
            <option value="vcenter">{{tr "vCenter"}}</option>
            <option value="custom">{{tr "Custom"}}</option>
          </select>
          <div>
            <label>{{tr "Custom TM_MAD"}}</label>
            <input type="text" name="ds_tab_custom_tm_mad" />
          </div>
        </div>
      </fieldset>
    </div>
  </div>
  <div class="row">
    <div class="large-12 columns">
      <fieldset>
        <legend>{{tr "Datastore Type"}}</legend>
        <div class="large-12 columns text-center">
          <input id="image_ds_type" type="radio" name="ds_type" value="IMAGE_DS" checked/>
          <label for="image_ds_type">{{tr "Images"}}</label>
          <input id="system_ds_type" type="radio" name="ds_type" value="SYSTEM_DS" />
          <label for="system_ds_type">{{tr "System"}}</label>
          <input id="file_ds_type" type="radio" name="ds_type" value="FILE_DS" />
          <label for="file_ds_type">{{tr "Files"}}</label>
        </div>
      </fieldset>
    </div>
  </div>
  <div class="row disk_type_wrapper">
    <div class="medium-6 columns">
      <label for="disk_type">{{tr "Disk type"}}</label>
      <select id="disk_type" name="disk_type">
        <option value="file">{{tr "File"}}</option>
        <option value="block">{{tr "Block"}}</option>
        <option value="RBD">{{tr "RBD"}}</option>
        <option value="gluster">{{tr "Gluster"}}</option>
        <option value="iscsi">{{tr "iSCSI/Libvirt"}}</option>
      </select>
    </div>
  </div>
  <div class="row">
    <div class="large-12 columns">
      <label>
        {{tr "Restricted directories for registering Images"}}
        <input type="text" name="restricted_dirs" id="restricted_dirs" placeholder="/path/to/dir /path/to/other/dir"/>
      </label>
    </div>
    <div class="large-12 columns">
      <label>
        {{tr "Safe directories for registering Images"}}
        <input type="text" name="safe_dirs" id="safe_dirs" placeholder="/path/to/dir /path/to/other/dir"/>
      </label>
    </div>
    <div class="medium-6 columns">
      <label>
        {{tr "Storage usage limit (MB)"}}
        <input type="number" min="0" name="limit_mb" id="limit_mb" />
      </label>
    </div>
    <div class="medium-6 columns">
      <label for="limit_transfer_bw">
        {{tr "Transfer bandwidth limit (B/s)"}}
        <span class="tip">
          {{tr "Specify the maximum transfer rate in bytes/second when downloading images from a http/https URL. Suffixes K, M or G can be used."}}
        </span>
        <input type="text" name="limit_transfer_bw" id="limit_transfer_bw" />
      </label>
    </div>
    <div class="large-12 columns">
      <input id="no_decompress" type="checkbox" name="no_decompress" value="YES" />
      <label for="no_decompress">{{tr "Do not try to untar or decompress"}}</label>
    </div>
    <div class="large-12 columns">
      <input id="datastore_capacity_check" type="checkbox" name="datastore_capacity_check" value="YES" />
      <label for="datastore_capacity_check">
        {{tr "Check available capacity of the Datastore before creating a new Image"}}
      </label>
    </div>
    <div class="large-12 columns">
      <label for="bridge_list">
        {{tr "Host bridge list"}}
        <span class="tip">
          {{tr "Space separated list of servers to add new Images to the Datastore storage"}}
        </span>
      </label>
      <input type="text" name="bridge_list" id="bridge_list" />
    </div>
    <div class="medium-6 columns">
      <label for="vg_name">{{tr "Volume Group Name"}}</label>
      <input type="text" name="vg_name" id="vg_name" />
    </div>
    <div class="medium-6 columns">
      <label for="gluster_host">
        {{tr "Gluster Host"}}
        <span class="tip">
          {{tr "Host and port of one (and only one) Gluster server (host:port)"}}
        </span>
      </label>
      <input type="text" name="gluster_host" id="gluster_host" />
    </div>
    <div class="medium-6 columns">
      <label for="gluster_volume">
        {{tr "Gluster Volume"}}
        <span class="tip">{{tr "Gluster volume to use for the datastore"}}</span>
      </label>
      <input type="text" name="gluster_volume" id="gluster_volume" />
    </div>
    <div class="medium-6 columns">
      <label for="pool_name">
        {{tr "Ceph pool to store Images"}}
      </label>
      <input type="text" name="pool_name" id="pool_name" />
    </div>
    <div class="medium-6 columns">
      <label for="ceph_host">
        {{tr "Ceph host"}}
        <span class="tip">
          {{tr "Space-separated list of Ceph monitors"}}
        </span>
      </label>
      <input type="text" name="ceph_host" id="ceph_host" placeholder="host1 host2:port2"/>
    </div>
    <div class="medium-6 columns">
      <label for="ceph_user">
        {{tr "Ceph user"}}
        <span class="tip">
          {{tr "The username to interact with the Ceph cluster"}}
        </span>
      </label>
      <input type="text" name="ceph_user" id="ceph_user" />
    </div>
    <div class="medium-6 columns">
      <label for="ceph_secret">
        {{tr "Ceph secret"}}
        <span class="tip">
          {{tr "A generated UUID for a LibVirt secret"}}
        </span>
      </label>
      <input type="text" name="ceph_secret" id="ceph_secret" />
    </div>
    
    <div class="medium-6 columns">
      <label for="par_cpg">
        {{tr "3PAR CPG to store Images"}}
      </label>
      <input type="text" name="par_cpg" id="par_cpg" />
    </div>
    <div class="medium-6 columns">
      <label for="par_naming_type">
        {{tr "3PAR Naming"}}
        <span class="tip">
          {{tr "Volume names are created according to best practices naming conventions. <TYPE> part - can be prd for production servers, dev for development servers, tst for test servers or clustername... Volume name will be <TYPE>.one.<IMAGE_ID>.vv for ex. dev.one.1.vv or tst.one.3.vv"}}
        </span>
      </label>
      <input type="text" name="par_naming_type" id="par_naming_type" placeholder="clustername"/>
    </div>
    
    <div class="medium-12 columns">
      <label for="par_provisioning">
        {{tr "3PAR Provisioning type"}}
      </label>
      <select id="par_provisioning" name="par_provisioning">
        <option value="thin">{{tr "Thin Provisioning"}}</option>
        <option value="dedup">{{tr "Thin Deduplicated Provisioning"}}</option>
        <option value="compr">{{tr "Thin Compressed Provisioning"}}</option>
        <option value="compr-dedup">{{tr "Thin Compressed Deduplicated Provisioning"}}</option>
        <option value="full">{{tr "Full Provisioning"}}</option>
      </select>
    </div>
    <div class="medium-12 columns">
      <input id="par_qos_enable" type="checkbox" name="par_qos_enable" value="YES" />
      <label for="par_qos_enable">
        {{tr "3PAR Use QoS"}}
        <span class="tip">
          {{tr "Applied per VM, so if VM have multiple disks, them QoS policy applies to all VM disks minimum goals and maximum limits are shared. Persistent disks use QoS Rules attributes from IMAGE datastore. Non-Persistent disks use QoS Rules attributes from target SYSTEM datastore"}}
        </span>
      </label>
    </div>
    <div id="par_qos_params">
      <div class="medium-6 columns">
        <label for="par_qos_max_iops">
          {{tr "QoS Max IOPS"}}
          <span class="tip">
            {{tr "The maximum IOPS permitted for the virtual volumes associated with the policy. The IOPS maximum limit must be between 0 and 2 147 483 647 IO/s."}}
          </span>
        </label>
        <input type="text" name="par_qos_max_iops" id="par_qos_max_iops" />
      </div>
      <div class="medium-6 columns">
        <label for="par_qos_min_iops">
          {{tr "QoS Min IOPS"}}
          <span class="tip">
            {{tr "If IOPS fall below this minimum goal, then IOPS will not be throttled (reduced) for the virtual volumes associated with the policy. If a minimum goal is set for IOPS, then a maximum limit must also be set for IOPS. The minimum goal will be ignored if the system does not have policies with a latency goal set. The IOPS minimum goal must be between 0 and 2 147 483 647 IO/s."}}
          </span>
        </label>
        <input type="text" name="par_qos_min_iops" id="par_qos_min_iops" />
      </div>
      <div class="medium-6 columns">
        <label for="par_qos_max_bw">
          {{tr "QoS Max Bandwidth in kB/s"}}
          <span class="tip">
            {{tr "The maximum bandwidth permitted for the virtual volumes associated with the policy. The maximum limit does not have dependencies on the other optimization settings. The bandwidth maximum limit must be between 0 and 9 007 199 254 740 991 KB/s."}}
          </span>
        </label>
        <input type="text" name="par_qos_max_bw" id="par_qos_max_bw" />
      </div>
      <div class="medium-6 columns">
        <label for="par_qos_min_bw">
          {{tr "QoS Min Bandwidth in kB/s"}}
          <span class="tip">
            {{tr "If bandwidth falls below this minimum goal, then bandwidth will not be throttled (reduced) for the virtual volumes associated with the policy. If a minimum goal is set for bandwidth, then a maximum limit must also be set for bandwidth. The minimum goal will be ignored if the system does not have policies with a latency goal set. The bandwidth minimum goal must be between 0 and 9 007 199 254 740 991 KB/s"}}
          </span>
        </label>
        <input type="text" name="par_qos_min_bw" id="par_qos_min_bw" />
      </div>
      <div class="medium-6 columns">
        <label for="par_qos_priority">
          {{tr "QoS Priority"}}
          <span class="tip">
            {{tr "Determines the sequence for throttling policies to meet latency goals. High priority should be used for critical applications, lower priority should be used for less critical applications. The priority will be ignored if the system does not have policies with a latency goal and minimum goal."}}
          </span>
        </label>
        <select id="par_qos_priority" name="par_qos_priority">
          <option value="NORMAL">{{tr "Normal"}}</option>
          <option value="LOW">{{tr "High"}}</option>
          <option value="HIGH">{{tr "Low"}}</option>
        </select>
      </div>
      <div class="medium-6 columns">
        <label for="par_qos_latency">
          {{tr "QoS Latency in ms"}}
          <span class="tip">
            {{tr "Service time that the system will attempt to achieve for the virtual volumes associated with the policy. A latency goal requires the system to have other policies with a minimum goal specified so that the latency goal algorithm knows which policies to throttle. The sequence in which these will be throttled is set by priority (low priority is throttled first). The latency goal must be between 0,50 and 10 000,00 ms."}}
          </span>
        </label>
        <input type="text" name="par_qos_latency" id="par_qos_latency" />
      </div>
    </div>
    
    <div class="medium-6 columns">
      <label for="iscsi_host">
        {{tr "iSCSI host"}}
        <span class="tip">
          {{tr "Example: 'host' or 'host:port'"}}
        </span>
      </label>
      <input type="text" name="iscsi_host" id="iscsi_host" />
    </div>
    <div class="medium-6 columns">
      <label for="iscsi_user">
        {{tr "iSCSI user for CHAP authentication"}}
      </label>
      <input type="text" name="iscsi_user" id="iscsi_user" />
    </div>
    <div class="medium-6 columns">
      <label for="iscsi_usage">
        {{tr "iSCSI usage for CHAP authentication"}}
        <span class="tip">
          {{tr "'Usage' of the registered secret with the authentication string."}}
        </span>
      </label>
      <input type="text" name="iscsi_usage" id="iscsi_usage" />
    </div>
    <div class="medium-6 columns">
      <label for="vceter_cluster">
        {{tr "vCenter cluster"}}
        <span class="tip">
          {{tr "The vCenter Cluster that has access to this datastore."}}
        </span>
        <div id="vcenter_cluster_wrapper"></div>
      </label>
    </div>
  </div>
  <div class="ceph_advanced">
    {{#advancedSection (tr "Advanced options") }}
    <div class="medium-6 columns">
      <label class="fs" for="staging_dir">
        {{tr "Staging directory for Image registration"}}
      </label>
      <input type="text" name="staging_dir" id="staging_dir" />
    </div>
    <div class="medium-6 columns">
      <label class="only_img_ds" for="compatible_sys_ds">
        {{tr "Compatible system datastores"}} 
        <span class="tip">
          {{tr "Specifies which system datastores are compatible with this image datastore"}}
        </span>
      </label>
      <input class="only_img_ds" type="text" name="compatible_sys_ds" id="compatible_sys_ds" placeholder="0,100" />
    </div>
    <div class="medium-6 columns">
      <label for="rbd_format">
        {{tr "RBD format"}}
      </label>
      <input type="text" name="rbd_format" id="rbd_format" />
    </div>
    <div class="medium-6 columns">
      <label class="fs" for="ceph_conf">
        {{tr "Ceph configuration file path"}}
        <span class="tip">
          {{tr "Needed if using a non-default path for the ceph configuration file."}}
        </span>
      </label>
      <input type="text" name="ceph_conf" id="ceph_conf" />
    </div>
    <div class="medium-6 columns">
      <label class="fs" for="ceph_key">
        {{tr "Ceph keyfile"}}
        <span class="tip">
          {{tr "File containing the secret key of user."}}
        </span>
      </label>
      <input type="text" name="ceph_key" id="ceph_key" />
    </div>
    {{/advancedSection}}
  </div>
</form>
